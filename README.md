# Русский калькулятор с дробями

Кратко: этот скрипт умеет парсить и вычислять простые выражения, записанные словами на русском: целые числа, правильные дроби ("пять седьмых"), смешанные дроби ("один и четыре пятых") и операции `плюс`, `минус`, `умножить`. Поддерживает множественные ведущие `минус` (например `---три`) и автоматически упрощает результат до смешанной дроби в выводе.

---

## Возможности

- Парсинг целых чисел и словесный вывод (например, `пять` → `5`, `двадцать три` ← `23`).
- Правильные и смешанные дроби: ввод и вывод в словесной форме.
- Операции: `плюс`, `минус`, `умножить`.
- Поддержка множественных ведущих `минус` (знак числа определяется по нечётности количества `минус`).
- Игнорирование служебного слова `на` в выражении.

## Быстрый пример

```
Введите выражение: минус один плюс один
Итог: ноль

Введите выражение: одна шестая умножить две третьих
Итог: одна девятая

Введите выражение: один и четыре пятых плюс шесть седьмых
Итог: две и двадцать три тридцать пятых
```

---

## Запуск

1. Сохраните код в файл `calculator.py`.
2. Запустите в терминале:

```bash
python calculator.py
```

3. Вводите выражения в одну строку (слова по пробелам). Чтобы выйти — ответьте `нет` на приглашение "Еще раз?".

---

## Формат входа (правила парсинга)

- В выражении должно быть ровно одно логическое действие: `число (или дробь) оператор число (или дробь)`.
- Числа могут быть:
  - целыми: `один`, `двадцать три`;
  - правильными дробями: `пять седьмых` (знаменатель — одно слово `седьмых`, `третьих` и т.п.);
  - смешанными дробями: `один и четыре пятых`.
- Перед числом можно ставить любое количество слов `минус` — они формируют знак числа.
- Слово `на` игнорируется (можно писать `умножить на`).

**Важно:** при вводе знаменателя ожидается *одно слово* порядкового типа (`седьмых`, `пятых`). Варианты ввода вроде `тридцать пять-ых` или `тридцать пять седьмых` (двухсловные знаменатели) распознаются не полностью — это можно добавить отдельно.

---

## Структура и описание функций

- `words_to_number(words_list)` — суммирует элементы списка слов по словарю `numbers_dict`.
- `clean_fraction_word(word)` — убирает суффиксы (`ая`, `ых`, `ого`, `ое`) от слова типа `седьмых` → `седьм`.
- `parse_fraction(words)` — ожидает `["числитель", "падежный_знаменатель"]` и возвращает `(числитель, знаменатель)`.
- `parse_number(words)` — парсит целые, правильные и смешанные дроби, учитывает одиночный ведущий `минус` и `--` (двойной минус удаляется).
- `fraction_name(denom, remainder=False)` — строит словесное название знаменателя в нужной форме (например `пятых`, `тридцать пятых`).
- `fraction_to_words(frac)` — переводит `Fraction` в словесную форму: целая часть + остаток с названием знаменателя.
- `number_to_word(n)` — числительное в слова (работает для положительных/отрицательных чисел, примерно до сотен).
- `calc_expression(words)` — основной парсер выражения: убирает `на`, обрабатывает ведущие `минус`, находит оператор, парсит левую/правую части и выполняет вычисление.
- `run_calc()` — CLI-цикл.

---

## Ограничения и возможные улучшения

1. **Входные знаменатели**: парсер ожидает знаменатель как одно слово порядкового типа (например `седьмых`). Поддержка двухсловных знаменателей (`тридцать пять-ых`) не реализована.
2. **Диапазон чисел**: словарь `numbers_dict` покрывает значения до 100. Если нужны большие числа — добавьте соответствующие записи и/или расширенный парсер для составных чисел.
3. **Операции**: пока только `плюс`, `минус`, `умножить`. Можно добавить `делить` и обработку приоритетов (скобки, порядок операций) — это следующая итерация.
4. **Морфология**: функция `fraction_name` формирует корректные формы для большинства практических знаменателей, но для некоторых редких случаев может понадобиться дополнительное лексическое правило (особенно для сложных десятков).

---

## Тестовые случаи (рекомендуется прогнать вручную)

- `минус один плюс один` → `ноль`
- `---три плюс --две` → `минус один`
- `один и четыре пятых плюс шесть седьмых` → `две и двадцать три тридцать пятых`
- `одна шестая умножить на две третьих` → `одна девятая`
- `пять седьмых умножить на девять третьих` → корректный результат с сокращением/смешанной дробью

---

## Дальше (идеи для развития)

- Поддержка `делить` и приоритета операций (или полностью выражений с несколькими операциями и скобками).
- Расширение словаря числительных (>1000) и поддержка сложных составных чисел во входе.
- Поддержка разных форм ввода знаменателей (двухсловные, дефисированные и пр.).
- Юнит-тесты для всех парсерных случаев.

---

## Лицензия

Этот код можно использовать и модифицировать как угодно.

